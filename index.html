<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TZG5YSD728"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TZG5YSD728');
</script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Random Quranic Verse</title>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <style>
/* Common Button Styles */
.button,
button,
#bookmarkButton,
.popup button,
#exit-button,
.menu-button,
.exit-button,
.menu-item,
#verse-of-the-day-button {
  display: inline-block;
  outline: 0;
  cursor: pointer;
  border: 2px solid #000;
  border-radius: 3px;
  color: #ffffff;
  background: #4a4a4a;
  font-size: 20px; /* Default size */
  font-weight: 600;
  line-height: 28px;
  text-align: center;
  transition-duration: .15s;
  transition-property: all;
  transition-timing-function: cubic-bezier(.4, 0, .2, 1);
  padding: 12px 20px; /* Default padding */
}

/* Medium-sized Button Styles */
.button.medium,
button.medium,
#bookmarkButton.medium,
.popup button.medium,
#exit-button.medium,
.menu-button.medium,
.exit-button.medium,
.menu-item.medium,
#verse-of-the-day-button.medium {
  font-size: 16px;
  padding: 10px 16px;
}

.button:hover,
button:hover,
#bookmarkButton:hover,
.popup button:hover,
#exit-button:hover,
.menu-button:hover,
.exit-button:hover,
.menu-item:hover,
#verse-of-the-day-button:hover,
.button.medium:hover,
button.medium:hover,
#bookmarkButton.medium:hover,
.popup button.medium:hover,
#exit-button.medium:hover,
.menu-button.medium:hover,
.exit-button.medium:hover,
.menu-item.medium:hover,
#verse-of-the-day-button.medium:hover {
  color: #61dafb;
  box-shadow: 0 0 20px rgba(97, 218, 251, 0.8);
  transform: scale(1.05);
}

/* Rest of your existing styles */
/* ... (Include the rest of your original styles below this line) ... */

        #bookmarkButton {
            padding: 12px 18px;
            background-color: #3933338b;
            color: #fff;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 18px;
          }
          
          #bookmarkButton:hover {
            background-color: #5f6467;
          }
          
          .popup {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            padding: 24px;
            background-color: #1f1e1e;
            border: 2px solid #646060;
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.2);
            z-index: 1000;
            max-width: 450px;
            text-align: center;
          }
          
          .popup button {
            margin-top: 20px;
            padding: 10px 18px;
            background-color: #3933338b;
            color: #fff;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 18px;
          }
          
          .popup button:hover {
            background-color: #646464aa;
          }
          
          #bookmarkedVersesContainer {
            max-height: 250px;
            overflow-y: auto;
            margin-bottom: 20px;
          }
          
          .bookmarkedVerse {
            padding: 10px;
            background-color: #f9f9f9;
            margin-bottom: 10px;
            box-shadow: 0 0 8px rgb(149, 111, 111);
            border-radius: 6px;
            text-align: left;
            line-height: 1.6;
          }
          
          #verse-container {
            position: relative;
            text-align: center;
            padding: 24px;
            background-color: rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            box-shadow: 0 0 20px rgba(255, 255, 255, 0.3);
            transition: box-shadow 0.3s ease-in-out;
            margin-top: 30px;
          }
          #progressBar {
            width: 100%;
            height: 8px;
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            z-index: 9;
            background: linear-gradient(to right, #4CAF50 0%, #3498db 50%, #4CAF50 100%);
            animation: smoothFill 0.4s linear forwards;
            display: none;
            border-radius: 4px;
            overflow: hidden;
          }
          
          @keyframes smoothFill {
            to {
              background: linear-gradient(to right, #4CAF50 100%, #3498db 100%, #4CAF50 100%);
            }
          }
        #progressBar::-webkit-progress-value {
            background: #ffffff; /* Set the color for the progress value */
            transition: width 0.3s linear; /* Adjust the duration based on your preference */
        }
#reciterDropdown {
    width: 100%;
    padding: 8px;
    font-size: 16px;
    border: 1px solid #000000;
    border-radius: 4px;
    margin-bottom: 10px;
}

/* Style for reciterDropdown options */
#reciterDropdown option {
    font-size: 14px;
    background-color: #090909c3;
    color: #ffffff;
    text-align: center; /* Center the text within the option */
    padding: 0; /* Remove padding */
}



        .switch {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 34px;
        }
        
        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            border-radius: 34px;
        }
        
        .slider:before {
            position: absolute;
            content: "";
            height: 26px;
            width: 26px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            border-radius: 50%;
            transition: transform 0.4s;
        }
        
        input:checked + .slider:before {
            transform: translateX(26px);
        }
        
        input:checked + .slider {
            background-color: #2196F3;
        }
        
        input:focus + .slider {
            box-shadow: 0 0 1px #2196F3;
        }
               
        .about-container {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: rgba(0, 0, 0, 0.863);
            color: #fff;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(255, 255, 255, 0.6);
            z-index: 1000;
            display: none; /* Initially hide the container */
        }
        
        .about-container p {
            margin-bottom: 15px;
        }
        
        /* Add styles to close the about container when clicked outside */
        body:not(.menu-open) .about-container {
            display: none;
        }
        
    /* Add your CSS styling for the update screen here */
    #update-screen {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.816);
        color: #fff;
        justify-content: center;
        align-items: center;
        text-align: center;
      }
      #update-content {
        padding: 20px;
      }
  
      #exit-button {
        padding: 10px 20px;
        background-color: #fff;
        color: #333;
        cursor: pointer;
        border: none;
        font-size: 16px;
        margin-top: 20px;
      }

    .menu-button:hover {
        background-color: #45a049;
    }

    /* Add this style to hide the Verse of the Day container initially */
    #verse-of-the-day-container {
        display: none;
        text-align: center;
        padding: 20px;
        background-color: rgba(255, 255, 255, 0.2);
        border-radius: 10px;
        box-shadow: 0 0 20px rgba(255, 255, 255, 0.3);
        margin-top: 20px;
    }

    /* Add your existing styles below this line */
    #verse-of-the-day-container {
        text-align: center;
        padding: 20px;
        background-color: rgba(255, 255, 255, 0.2);
        border-radius: 10px;
        box-shadow: 0 0 20px rgba(255, 255, 255, 0.3);
        margin-top: 20px;
    }

    /* Add your existing styles below this line */
    .menu-middle {
        padding: 20px;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
    }

    /* Add your existing styles below this line */
    .instagram-container {
        margin-top: 20px;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    /* Add your existing styles below this line */
    .instagram-container img {
        width: 30px;
        height: 30px;
        border: 0;
        margin-right: 10px;
    }

    /* Add your existing styles below this line */
    .exit-button {
        margin-top: auto;
    }

    /* Add your existing styles below this line */
    .exit-button:hover {
        background-color: #e74c3c;
        color: #fff;
        box-shadow: 0 0 20px rgba(255, 255, 255, 0.6);
    }

    /* Add your existing styles below this line */
    body {
        background-image: url('https://winstonchurchill.hillsdale.edu/wp-content/uploads/2016/03/3855627586_4db6944f4e_o-840x430.jpg');
        background-size: cover;
        background-position: center;
        background-repeat: no-repeat;
        color: #ffffff;
        text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
        transition: background-image 0.3s ease-in-out;
        display: flex;
        align-items: center;
        justify-content: center;
        height: 100vh;
        margin: 0;
        position: relative;
    }

    /* Add your existing styles below this line */
    body::before {
        content: '';
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.4);
        z-index: -1;
    }

    /* Add your existing styles below this line */
    .dark-theme {
        background-color: #111;
        color: #fff;
    }

    /* Add your existing styles below this line */
    #verse-container {
        text-align: center;
        padding: 20px;
        background-color: rgba(255, 255, 255, 0.2);
        border-radius: 10px;
        box-shadow: 0 0 20px rgba(255, 255, 255, 0.3);
        transition: box-shadow 0.3s ease-in-out;
        margin-top: 20px;
    }

    /* Add your existing styles below this line */
    @media (max-width: 767px) {
        /* Styles for screens with a maximum width of 767px (typical phones) */
        #verse-container {
            padding: 10px;
        }

        #verse {
            font-size: 1.2em;
        }
    }

    @media (min-width: 768px) and (max-width: 1199px) {
        /* Styles for screens with a width between 768px and 1199px (typical tablets) */
        #verse-container {
            padding: 15px;
        }
    }

    @media (min-width: 1200px) {
        /* Styles for screens with a minimum width of 1200px (typical desktops and larger) */
        #verse-container {
            margin-top: 100px;
        }
    }

    /* Add your existing styles below this line */
    body {
        display: flex;
        align-items: center;
        justify-content: center;
        height: 100vh;
        margin: 0;
        background-color: #282c35;
        color: #ffffff;
        transition: background-color 0.3s ease-in-out;
        position: relative;
    }

    /* Add your existing styles below this line */
    .dark-theme {
        background-color: #111;
        color: #fff;
    }

    /* Add your existing styles below this line */
    #verse-container {
        text-align: center;
        padding: 20px;
        background-color: rgba(255, 255, 255, 0.2);
        border-radius: 10px;
        box-shadow: 0 0 20px rgba(255, 255, 255, 0.3);
        transition: box-shadow 0.3s ease-in-out;
        margin-top: 20px;
    }

    /* Add your existing styles below this line */
    #verse-container:hover {
        box-shadow: 0 0 40px rgba(255, 255, 255, 0.6);
    }

    /* Add your existing styles below this line */
    h1 {
        font-size: 2em;
        margin-bottom: 10px;
        transition: color 0.3s ease-in-out;
        position: absolute;
        top: 20px;
        left: 50%;
        transform: translateX(-50%);
        z-index: 2;
      }
      
      .dark-theme h1 {
        color: #424a52;
      }
      
    /* Add your existing styles below this line */
    #verse {
        font-size: 1.5em;
        margin-bottom: 5px;
        background-color: transparent;
        color: #fff;
        transition: font-size 0.5s ease-in-out, color 0.5s ease-in-out;
    }

    /* Add your existing styles below this line */
    #translation {
        font-size: 1em;
        color: #ddd;
        transition: font-size 0.5s ease-in-out, color 0.5s ease-in-out;
    }

    /* Add your existing styles below this line */
    #verse-number {
        font-size: 0.8em;
        color: #777;
    }

    /* Add your existing styles below this line */
    #audioControl {
        display: inline-flex;
        align-items: center;
        cursor: pointer;
        margin-left: 10px;
    }

    /* Add your existing styles below this line */
    #audioControl img {
        width: 30px;
        height: 30px;
        border: 0;
    }

    /* Add your existing styles below this line */
    #menu {
        position: fixed;
        top: 20px;
        right: 20px;
        display: flex;
        flex-direction: column;
        align-items: flex-end;
        cursor: pointer;
        z-index: 100;
    }

    /* Add your existing styles below this line */
    #menuArrow {
        font-size: 3.5em;
        margin-bottom: 10px;
        transition: transform 0.3s ease-in-out, color 0.3s ease-in-out;
        transform: rotate(180deg);
        color: #555555;
    }

    /* Add your existing styles below this line */
    #menuArrow:hover {
        transform: scale(1.1);
    }

    /* Add your existing styles below this line */
    .menu-items {
        display: flex;
        flex-direction: column;
        position: fixed;
        top: 0;
        right: -50%;
        height: 100%;
        width: 0;
        background-color: #333;
        border-radius: 5px;
        box-shadow: 0 0 20px rgba(255, 255, 255, 0.6);
        overflow: hidden;
        transition: width 0.5s ease-in-out, right 0.5s ease-in-out;
        z-index: 101;
    }

    /* Add your existing styles below this line */
    .menu-top {
        padding: 20px;
        display: flex;
        flex-direction: column;
        align-items: center;
    }

    /* Add your existing styles below this line */
    .menu-bottom {
        margin-top: auto;
        padding: 20px;
        display: flex;
        flex-direction: row;
        align-items: center;
        justify-content: center;
        gap: 10px;
    }

    /* Add your existing styles below this line */
    .menu-item,
    .menu-bottom a {
        color: #fff;
        padding: 15px;
        cursor: pointer;
        transition: background-color 0.3s ease-in-out, color 0.3s ease-in-out, box-shadow 0.3s ease-in-out, transform 0.3s ease-in-out;
        border-radius: 5px;
        text-align: center;
        margin-bottom: 10px;
        background-color: #555;
        position: relative;
        z-index: 1;
    }

    /* Add your existing styles below this line */
    .menu-bottom a img {
        width: 30px;
        height: 30px;
        border: 0;
        display: block;
    }

    /* Add your existing styles below this line */
    .menu-item:hover,
    .menu-bottom a:hover {
        color: #61dafb;
        box-shadow: 0 0 20px rgba(97, 218, 251, 0.8);
        transform: scale(1.05);
    }

    /* Add your existing styles below this line */
    .menu-item:active,
    .menu-bottom a:active {
        box-shadow: 0 0 5px rgba(97, 218, 251, 0.8);
        transform: scale(0.95);
    }

    /* Add your existing styles below this line */
    .menu-item:focus,
    .menu-bottom a:focus {
        outline: none;
    }

    /* Add your existing styles below this line */
    #volumeSlider {
        width: 80%;
        margin: 10px 0;
    }

    /* Add your existing styles below this line */
    input[type="range"] {
        width: 80%;
        margin: 10px 0;
    }

    #share-buttons {
        position: fixed;
        top: 30px;
        right: 30px;
        display: flex;
        z-index: 2;
      }
      
      #share-buttons a {
        margin-right: 12px;
      }
      
      #share-buttons img {
        width: 40px;
        height: 40px;
        border: 0;
        cursor: pointer;
      }
      
      #share-buttons .instagram-icon {
        width: 40px;
        height: 40px;
        background-image: url('your-instagram-icon-url');
        background-size: cover;
        border-radius: 50%;
      }
      
      #audioPlayer {
        margin-top: 30px;
        cursor: pointer;
        position: relative;
        transition: transform 0.5s ease-in-out;
      }
      
      #audioPlayer:hover {
        transform: scale(1.2);
      }
      
      #audioPlayer img {
        width: 40px;
        height: 40px;
        border: 0;
      }
    </style>
</head>
<body>
    <h1>Random Quranic Verse</h1>
    <div id="bookmarksPopup" class="popup">
        <div id="bookmarkedVersesContainer"></div>
        <button onclick="hideBookmarksPopup()">Exit</button>
        <!-- Add a button to clear bookmarked verses -->
        <button id="clearBookmarksButton">Clear Bookmarks</button>
    </div>
    <div id="update-screen">
        <div id="update-content">
          <h2>New Update!</h2>
          <p>bugs fixes</p>
          <p>تم تعديل جز من العطال</p>
          <p></p>
          <p></p>
          <p></p>
          <p></p>
          <p></p>
          <p></p>


          <button id="exit-button">Exit</button>
        </div>
      </div>
    <div id="menu" onclick="toggleMenu()">
        <div id="menuArrow">&#8592;</div>
        <div class="menu-items" id="menuItems">
            <div class="menu-top">
                <div class="menu-item">
                    <label class="switch" for="themeToggle">
                        <input type="checkbox" id="themeToggle" onclick="changeTheme()">
                        <div class="slider round"></div>
                    </label>
                    <span class="toggle-label">Toggle Theme</span>
                </div>
                <input type="range" min="0.8" max="2.0" step="0.1" value="1.5" id="sizeSlider" oninput="changeVerseSize(this.value)">
                <div class="menu-item" onclick="showAbout(event)">About</div>
            </div>
            <div class="menu-middle">
                <button id="showBookmarksButton" onclick="showBookmarksPopup()">Show Bookmarks</button>
                <label for="reciterDropdown">Select Reciter:</label>
                <select id="reciterDropdown" onchange="changeReciter(this.value)">
                    <option value="ar.abdulbasitmurattal">Abdul Basit</option>
                    <option value="ar.abdullahbasfar">Abdullah Basfar</option>
                    <option value="ar.abdurrahmaansudais">Abdurrahmaan As-Sudais</option>
                    <option value="ar.abdulsamad">Abdul Samad</option>
                    <option value="ar.shaatree">Abu Bakr Ash-Shaatree</option>
                    <option value="ar.ahmedajamy">Ahmed ibn Ali al-Ajamy</option>
                    <option value="ar.alafasy">Alafasy</option>
                    <option value="ar.hanirifai">Hani Rifai</option>
                    <option value="ar.husary">Husary</option>
                    <option value="ar.husarymujawwad">Husary (Mujawwad)</option>
                    <option value="ar.hudhaify">Hudhaify</option>
                    <option value="ar.ibrahimakhbar">Ibrahim Akhdar</option>
                    <option value="ar.mahermuaiqly">Maher Al Muaiqly</option>
                    <option value="ar.minshawi">Minshawi</option>
                    <option value="ar.minshawimujawwad">Minshawy (Mujawwad)</option>
                    <option value="ar.muhammadayyoub">Muhammad Ayyoub</option>
                    <option value="ar.muhammadjibreel">Muhammad Jibreel</option>
                    <option value="ar.saoodshuraym">Saood bin Ibraaheem Ash-Shuraym</option>
                    <option value="en.walk">Ibrahim Walk</option>
                    <option value="fa.hedayatfarfooladvand">Fooladvand - Hedayatfar</option>
                    <option value="ar.parhizgar">Parhizgar</option>
                    <option value="ur.khan">Shamshad Ali Khan</option>
                    <option value="zh.chinese">Chinese</option>
                    <option value="fr.leclerc">Youssouf Leclerc</option>
                    <option value="ar.aymanswoaid">Ayman Sowaid</option>
                    <option value="ru.kuliev-audio">Elmir Kuliev by 1MuslimApp</option>
                </select>
                <button class="menu-button" onclick="toggleVerseOfTheDayContainer()">Toggle Verse of the Day</button>
                <label for="changevolume">changeVolume:</label>
                <input type="range" min="0" max="1" step="0.1" value="1" id="volumeSlider" oninput="changeVolume(this.value)">
                <div class="about-container" id="aboutContainer" onclick="event.stopPropagation()">
                    <h2>About This Website</h2>
                    <p>This website provides a random Quranic verse along with audio recitation and translation. Explore the beauty of the Quran through random verses.</p>
                    <p>For bug reporting or feedback, please click the button below:</p>
                    <button id="reportBugButton" onclick="reportBug()">Report Bug</button>
                </div>                 
            </div>
            
            <div class="menu-bottom">
                <!-- GitHub icon -->
                <a class="menu-item" href="https://github.com/Yazanking" target="_blank">
                    <img src="https://cdn-icons-png.flaticon.com/512/25/25231.png" alt="GitHub Icon">
                </a>
                <!-- Instagram icon -->
                <a class="menu-item" href="https://www.instagram.com/1__7yzn/" target="_blank">
                    <img src="https://cdn-icons-png.flaticon.com/512/725/725339.png" alt="Instagram Icon">
                </a>
            </div>
        </div>
    </div>
</body>
    <div id="verse-container" data-verse-reference="">    
        <div id="verse-content">
            <div id="verse-of-the-day-container">
                <h2>Verse of the Day</h2>
                <p id="verse-of-the-day"></p>
            </div>            
            <div id="audioControl" onclick="toggleAudio()">
                <img src="https://img.icons8.com/material-rounded/24/000000/speaker.png" alt="Audio Control">
            </div>
            <p id="verse"></p>
            <p id="translation"></p>
            <p id="verse-number"></p>
            <button id="bookmarkButton" onclick="bookmarkCurrentVerse()">Bookmark This Verse</button>
            <!-- Add this HTML for the progress bar -->
<progress id="progressBar" value="0" max="100"></progress>
        </div>
    </div>
    <script>
        
        let isMenuVisible = false;
        let verseChangeTimer;
        let isAudioPlaying = false;
        let currentAudioPlayer;
        
        document.addEventListener("DOMContentLoaded", function () {
            // Set the current version number
            const currentVersion = "2.5"; // Change this to your current version
        
            // Check if the user has seen the update for the current version
            const hasSeenUpdateForVersion = localStorage.getItem(`hasSeenUpdate_${currentVersion}`);
          
            if (!hasSeenUpdateForVersion) {
              showUpdateScreen();
          
              // Set the flag in local storage to indicate that the user has seen the update for this version
              localStorage.setItem(`hasSeenUpdate_${currentVersion}`, "true");
            }
          
    // Function to display the update screen
    function showUpdateScreen() {
        const updateScreen = document.getElementById("update-screen");
        const exitButton = document.getElementById("exit-button");

        updateScreen.style.display = "flex";

        // Add event listener to exit button
        exitButton.addEventListener("click", function () {
            updateScreen.style.display = "none";
        });
    }
});

async function fetchVerse(verseNumber) {
    try {
        const verseData = await getVerseData(verseNumber);
        const translationData = await getTranslationData(verseNumber);
        const audioUrl = await getAudioUrl(verseNumber);
        updateVerseUI(verseData.text, translationData.text, verseData.number);
        setVerseReference(verseData.number);
        playAudioInternal(audioUrl);
        return audioUrl;
    } catch (error) {
        handleErrors(error, 'Error fetching verse:');
    }
}    
        const VERSE_OF_THE_DAY_INTERVAL = 24 * 60 * 60 * 1000;

        window.onload = async () => {
            await fetchVerse();
            startVerseChangeTimer();
            fetchRandomVerseOfTheDay();
            // Add this line to fetch the Verse of the Day
        };
        
        // Add this line to fetch the Verse of the Day on a specified interval
        setInterval(fetchRandomVerseOfTheDay, VERSE_OF_THE_DAY_INTERVAL);
        
        function showAbout(event) {
            event.stopPropagation(); // Prevent the event from reaching the document
            const aboutContainer = document.getElementById("aboutContainer");
            aboutContainer.style.display = (aboutContainer.style.display === "block") ? "none" : "block";
        }
        function reportBug() {
            // Redirect to your Instagram account
            window.location.href = "https://www.instagram.com/1__7yzn/";
        }        
        function toggleVerseOfTheDayContainer() {
            const verseOfTheDayContainer = document.getElementById('verse-of-the-day-container');
            if (verseOfTheDayContainer.style.display === 'none' || !verseOfTheDayContainer.style.display) {
                verseOfTheDayContainer.style.display = 'block';
            } else {
                verseOfTheDayContainer.style.display = 'none';
            }
        }
        const API_BASE_URL = 'https://api.alquran.cloud/v1/ayah';
        const EDITION_IDENTIFIER = 'ar.alf'; // Default edition identifier
        let EDITIONS = 'ar.Alafasy';
        const TRANSLATION_EDITIONS = 'en.sahih';        
        const VERSE_CHANGE_INTERVAL = 10000;
        async function fetchVerse(verseNumber) {
            try {
                if (!verseNumber) {
                    verseNumber = getRandomVerseNumber();
                }

                const verseData = await getVerseData(verseNumber);
                const translationData = await getTranslationData(verseNumber);
                updateVerseUI(verseData.text, translationData.text, verseData.number);
                setVerseReference(verseData.number);
                return verseData.audio;
            } catch (error) {
                handleErrors(error, 'Error fetching verse:');
            }
        }
        async function getTranslationData(verseNumber) {
            const response = await axios.get(`${API_BASE_URL}/${verseNumber}/${TRANSLATION_EDITIONS}`);
            return response.data.data;
        }
        async function playAudioInternal(audioUrl) {
            const audioPlayer = new Audio(audioUrl);
        
            audioPlayer.addEventListener('ended', () => {
                isAudioPlaying = false;
                setTimeout(() => {
                    startVerseChangeTimer();
                }, 0); // Use setTimeout to allow the event loop to clear
            });
        
            audioPlayer.play();
        }
        
        
        function playAudioInternal(audioUrl) {
            const audioPlayer = new Audio(audioUrl);
            audioPlayer.play();
        
            audioPlayer.addEventListener('ended', () => {
                isAudioPlaying = false;
                if (verseChangeTimer) {
                    clearInterval(verseChangeTimer);
                    startVerseChangeTimer(); // Start a new timer after clearing the existing one
                }
            });
        }
        
        async function getVerseData(verseNumber) {
            const response = await axios.get(`${API_BASE_URL}/${verseNumber}/${EDITIONS}`);
            return response.data.data;
        }
        async function getAudioUrl() {
            const verseContainer = document.getElementById('verse-container');
            const verseReference = verseContainer.dataset.verseReference;

            if (verseReference) {
                const response = await axios.get(`${API_BASE_URL}/${verseReference}/editions/${EDITIONS}`);
                return response.data.data[0].audio;
            } else {
                throw new Error('Verse reference is undefined.');
            }
        }
        async function updateVerseUI(verseText, translationText, verseNumber) {
            const verseElement = document.getElementById('verse');
            const translationElement = document.getElementById('translation');
            const verseNumberElement = document.getElementById('verse-number');

            // Clear previous content
            verseElement.innerHTML = '';
            translationElement.innerHTML = '';
            verseNumberElement.innerHTML = '';

            // Display verse text and translation
            verseElement.innerHTML = `<strong>${verseText}</strong>`;
            translationElement.innerHTML = translationText;

            // Display verse number using the provided code
            verseNumberElement.innerText = `AYAH ${verseNumber}`;
        }

        function handleErrors(error, message) {
            console.error(`${message} ${error}`);
        }

        async function playAudioInternal(audioPlayer) {
            try {
                const audioUrl = await getAudioUrl();
                
                // Clear the existing timer if it exists
                clearInterval(verseChangeTimer);
        
                // Set the current audio player
                currentAudioPlayer = audioPlayer;
        
                // Add progress bar
                const progressBar = document.getElementById('progressBar');
                progressBar.style.display = 'block';
        
                // Update progress bar dynamically
                audioPlayer.addEventListener('timeupdate', () => {
                    const percentage = (audioPlayer.currentTime / audioPlayer.duration) * 100;
                    progressBar.value = percentage;
                });
        
                // Add event listener for when the audio ends
                audioPlayer.addEventListener('ended', () => {
                    isAudioPlaying = false; // Set the flag to indicate that audio is not playing
                    
                    // Start a new timer to change the verse after a rest interval
                    verseChangeTimer = setInterval(() => {
                        const randomVerseNumber = getRandomVerseNumber();
                        fetchVerse(randomVerseNumber);
                    }, VERSE_CHANGE_INTERVAL);
        
                    // Hide the progress bar
                    progressBar.style.display = 'none';
                });
        
                // Set the audio source and play
                audioPlayer.src = audioUrl;
                audioPlayer.play();
        
                isAudioPlaying = true; // Set the flag to indicate that audio is playing
            } catch (error) {
                handleErrors(error, 'Error playing audio:');
            }
        }
        
        function startVerseChangeTimer() {
            // Start the initial timer to change the verse every 10 seconds
            verseChangeTimer = setInterval(() => {
                if (!isAudioPlaying) {
                    const randomVerseNumber = getRandomVerseNumber();
                    fetchVerse(randomVerseNumber);
                }
            }, VERSE_CHANGE_INTERVAL);
        }
        
        function toggleAudio() {
            if (isAudioPlaying) {
                // If audio is already playing, do nothing
                return;
            } else {
                // If audio is not playing, play it
                isAudioPlaying = true;
                const audioPlayer = new Audio();
                playAudioInternal(audioPlayer);
            }
        }
        function getRandomVerseNumber(currentVerseNumber) {
            let randomVerseNumber;
            do {
                randomVerseNumber = Math.floor(Math.random() * 114 + 1);
            } while (randomVerseNumber === currentVerseNumber);
            return randomVerseNumber;
        }
        
        function setVerseReference(verseReference) {
            const verseContainer = document.getElementById('verse-container');
            verseContainer.dataset.verseReference = verseReference;
        }

        function toggleMenu() {
            const menuItems = document.getElementById('menuItems');
            if (!isMenuVisible) {
                showMenu();
            } else {
                hideMenu();
            }
        }
        

        function changeTheme() {
            const body = document.body;
            body.classList.toggle('dark-theme');
          }
          
        function changeVerseSize(size) {
            const verseElement = document.getElementById('verse');
            verseElement.style.fontSize = `${size}em`;
        }
        let startX = 0;
        
        document.addEventListener('touchstart', handleTouchStart, false);
        document.addEventListener('touchmove', handleTouchMove, false);
        
        function handleTouchStart(event) {
            startX = event.touches[0].clientX;
        }
        
        function handleTouchMove(event) {
            if (!startX) return;
        
            const currentX = event.touches[0].clientX;
            const deltaX = startX - currentX; // Adjusted for right swipe
        
            // Adjust this value based on the threshold for swipe to show the menu
            const swipeThreshold = 50;
        
            // Check for smaller screen width (adjust the value based on your needs)
            const isMobile = window.innerWidth <= 768;
        
            if (isMobile && deltaX > swipeThreshold) {
                showMenu();
                startX = 0; // Reset startX to prevent continuous triggering
            }
        }
        
        function showMenu() {
            const menuItems = document.getElementById('menuItems');
            menuItems.style.width = '50%'; // Adjust the width based on your preference
            menuItems.style.right = '0';
            isMenuVisible = true;
            document.getElementById('menuArrow').classList.add('arrow-rotate');
        }
        
        function hideMenu() {
            const menuItems = document.getElementById('menuItems');
            menuItems.style.width = '0';
            menuItems.style.right = '-50%';
            isMenuVisible = false;
            document.getElementById('menuArrow').classList.remove('arrow-rotate');
        }
        // Prevent the menu from closing when interacting with its content
        document.getElementById('menuItems').addEventListener('click', function (event) {
            event.stopPropagation(); // Prevent the click event from propagating to document
        });
        
        // Close the menu if the user clicks outside the menu
        document.addEventListener('click', function (event) {
            const menu = document.getElementById('menu');
        
            if (isMenuVisible && !menu.contains(event.target)) {
                hideMenu();
            }
        });
        async function fetchRandomVerseOfTheDay() {
            try {
                // Fetch the total number of Ayahs (verses) available
                const totalAyahs = 6236;  // Update this if the actual total number is different
        
                // Generate a random Ayah number
                const randomAyahNumber = Math.floor(Math.random() * totalAyahs) + 1;
        
                // Specify the Ayah number in the request
                const response = await axios.get(`${API_BASE_URL}/${randomAyahNumber}/${EDITIONS}`);
                const verseData = response.data.data;
        
                if (verseData && verseData.text) {
                    const verseOfTheDayElement = document.getElementById('verse-of-the-day');
        
                    // Display the Verse of the Day with Ayah number
                    verseOfTheDayElement.innerHTML = `<strong>${verseData.text}</strong><br>AYAH ${randomAyahNumber}`;
                } else {
                    throw new Error('Invalid response format for Verse of the Day. Verse data not available.');
                }
            } catch (error) {
                console.error('Error fetching Verse of the Day:', error);
        
                // Optionally, you can display a message to the user indicating the failure.
                const verseOfTheDayElement = document.getElementById('verse-of-the-day');
                verseOfTheDayElement.innerHTML = `Failed to fetch Verse of the Day. Please check the console for details.`;
            }
        }
        function showVolumeSlider() {
            const volumeSliderContainer = document.getElementById('volumeSliderContainer');
            volumeSliderContainer.style.display = 'block';
        }
        
function changeVolume(volume) {
    const audioPlayers = document.querySelectorAll('#verse-container audio');
    audioPlayers.forEach((audioPlayer) => {
        audioPlayer.volume = volume;
    });
}
   
               // Add this function to toggle the reciter list
        function toggleReciterList() {
            const reciterList = document.getElementById('reciterList');
            if (reciterList.style.display === 'none' || !reciterList.style.display) {
                reciterList.style.display = 'block';
            } else {
                reciterList.style.display = 'none';
            }
        }

        // Add this function to change the reciter and fetch the verse
        function changeReciter(reciterIdentifier) {
            EDITIONS = reciterIdentifier;
            // Fetch the verse with the selected reciter
            //fetchVerse(getRandomVerseNumber());
        }
        var originalBackgroundImage = 'url(https://winstonchurchill.hillsdale.edu/wp-content/uploads/2016/03/3855627586_4db6944f4e_o-840x430.jpg)';

        function changeTheme() {
            var body = document.body;
            var menu = document.getElementById('menu');
            var updateScreen = document.getElementById('update-screen');
        
            // Toggle dark mode class on body
            body.classList.toggle('dark-mode');
        
            // Toggle dark mode class on menu
            menu.classList.toggle('dark-mode');
        
            // Toggle dark mode class on update screen
            updateScreen.classList.toggle('dark-mode');
        
            // Additional styling for specific elements (adjust as needed)
            if (body.classList.contains('dark-mode')) {
                // Dark mode
                body.style.backgroundColor = '#000';
                body.style.backgroundImage = 'none';
                // Set text color to white
                body.style.color = '#fff';
                // Additional styling for other elements
            } else {
                // Light mode (reverting to original background)
                body.style.backgroundColor = '';
                body.style.backgroundImage = originalBackgroundImage;
                // Set text color to original color (e.g., black)
                body.style.color = '#000'; // Replace with your original text color
                // Additional styling for other elements
            }
        }
        function changeVolume(volume) {
            if (currentAudioPlayer) {
                currentAudioPlayer.volume = volume;
            }
        }
        let bookmarkedVerses = []; // Array to store bookmarked verses

function bookmarkCurrentVerse() {
    const verseContainer = document.getElementById('verse-container');
    const verseReference = verseContainer.dataset.verseReference;
    const verseText = document.getElementById('verse').innerHTML;
    const translationText = document.getElementById('translation').innerHTML;

    // Check if the verse is already bookmarked
    if (!isVerseBookmarked(verseReference)) {
        // Add the current verse to the bookmarks array
        bookmarkedVerses.push({
            verseReference,
            verseText,
            translationText
        });

        // Optionally, you can save the bookmarks array to local storage for persistence
        saveBookmarksToLocalStorage();

        // Provide feedback to the user (you can customize this part)
        alert('Verse bookmarked successfully!');
    } else {
        // The verse is already bookmarked
        alert('Verse is already bookmarked!');
    }
}

function isVerseBookmarked(verseReference) {
    // Check if the verse is already bookmarked
    return bookmarkedVerses.some(verse => verse.verseReference === verseReference);
}

function saveBookmarksToLocalStorage() {
    // Save the bookmarks array to local storage
    localStorage.setItem('bookmarkedVerses', JSON.stringify(bookmarkedVerses));
}

function loadBookmarksFromLocalStorage() {
    // Load bookmarks from local storage when the page loads
    const storedBookmarks = localStorage.getItem('bookmarkedVerses');
    if (storedBookmarks) {
        bookmarkedVerses = JSON.parse(storedBookmarks);
    }
}

function updateBookmarkedVersesContainer() {
    const container = document.getElementById('bookmarkedVersesContainer');
    container.innerHTML = '';

    bookmarkedVerses.forEach(verse => {
        const verseElement = document.createElement('div');
        verseElement.innerHTML = `<strong>${verse.verseText}</strong><br>${verse.translationText}`;
        container.appendChild(verseElement);
    });
}

// Load bookmarks from local storage when the page loads
document.addEventListener("DOMContentLoaded", function () {
    // ... (your existing code)
    loadBookmarksFromLocalStorage();
    updateBookmarkedVersesContainer(); // Update bookmarks container when the page loads
});

function showBookmarksPopup() {
    updateBookmarkedVersesContainer();
    const popup = document.getElementById('bookmarksPopup');
    popup.style.display = 'block';
}

function hideBookmarksPopup() {
    const popup = document.getElementById('bookmarksPopup');
    popup.style.display = 'none';
}
// Function to clear bookmarks
function clearBookmarks() {
    localStorage.removeItem('bookmarkedVerses');
    // You can add additional logic here if needed
    // For example, updating the UI to reflect the cleared bookmarks
}

// Add an event listener to the clear bookmarks button
document.getElementById('clearBookmarksButton').addEventListener('click', clearBookmarks);
</script>
</body>
</html>
